\RequirePackage{fancyhdr}         % Adaptation of the footers

% Setup for custom footer
\pagestyle{fancy}

\newlength{\nobgfooterheight}
\setlength{\nobgfooterheight}{\paperheight}
\addtolength{\nobgfooterheight}{-1in}
\addtolength{\nobgfooterheight}{-\topmargin}
\addtolength{\nobgfooterheight}{-\headheight}
\addtolength{\nobgfooterheight}{-\headsep}
\addtolength{\nobgfooterheight}{-\textheight}
\addtolength{\nobgfooterheight}{-\footskip}

\newcommand{\background}{book/img/background}
\newcommand{\backgroundl}{\background}
\newcommand{\backgroundr}{\background}

\renewcommand{\headrulewidth}{0.0pt} %no rule for header
\renewcommand{\footrulewidth}{0.0pt} %no rule for footer

% New chapter style that don't have number but included in toc and side-toc
\newcommand{\schapter}[1]{%
  \chapter*{#1}%
  \addcontentsline{toc}{chapter}{#1}%
}

\fancyhf{} % clear all headers and footers

\fancyhead[O]{
  \begin{tikzpicture}[remember picture,overlay]
    \node[inner sep=0pt] at (current page.center) {\includegraphics[width=\paperwidth,height=\paperheight]{\backgroundr}};
  \end{tikzpicture}
}

\fancyhead[E]{
  \begin{tikzpicture}[remember picture,overlay]
    \node[inner sep=0pt] at (current page.center) {\includegraphics[width=\paperwidth,height=\paperheight]{\backgroundl}};
  \end{tikzpicture}
}

\fancyfoot[LE]{
  \begin{tikzpicture}[remember picture,overlay]
    % \node[xscale=-1,inner sep=0pt,anchor=south,nearly opaque] at (current page.south) {\includegraphics[width=\paperwidth,height=43pt]{book/img/footerscroll}};
    \node[xshift=20pt,yshift=30pt] at (current page.south west) {\pfFooterFont\textcolor{pfFooterColor}{\thepage}};
    \node[anchor=south west,xshift=\marginparwidth+\marginparpush,yshift=23pt] at (current page.south west) {\pfFooterFont{\textcolor{pfFooterColor}{\nouppercase\leftmark}}};
  \end{tikzpicture}
}

\fancyfoot[RO]{
  \begin{tikzpicture}[remember picture,overlay]
    % \node[inner sep=0pt,anchor=south,nearly opaque] at (current page.south) {\includegraphics[width=\paperwidth,height=43pt]{book/img/footerscroll}};
    \node[xshift=-20pt,yshift=30pt] at (current page.south east) {\pfFooterFont\textcolor{pfFooterColor}{\thepage}};
    \node[anchor=south east,xshift=-\marginparwidth-\marginparpush,yshift=23pt] at (current page.south east) {\pfFooterFont{\textcolor{pfFooterColor}{\nouppercase\leftmark}}};
  \end{tikzpicture}
}

\fancypagestyle{plain}{}


\fancypagestyle{part}{
  \fancyhf{} % clear all headers and footers
  \fancyhead[O]{
    \begin{tikzpicture}[remember picture,overlay]
      \node[inner sep=0pt] at (current page.center) {\includegraphics[width=\paperwidth,height=\paperheight]{\backgroundr}};
      % \node[inner sep=0pt,anchor=north] at (current page.north) {\includegraphics[width=\paperwidth]{book/img/header-part-circ}};
      % \node[inner sep=0pt,anchor=north west] at (current page.north west) {\includegraphics[width=.5\paperwidth]{book/img/header-part}};
      % \node[xscale=-1, inner sep=0pt, anchor=north west] at (current page.north east) {\includegraphics[width=.5\paperwidth]{book/img/header-part}};
    \end{tikzpicture}
  }
}

\fancypagestyle{part}{
  \fancyhf{} % clear all headers and footers
  \fancyhead[E]{
    \begin{tikzpicture}[remember picture,overlay]
      \node[inner sep=0pt] at (current page.center) {\includegraphics[width=\paperwidth,height=\paperheight]{\backgroundl}};
      % \node[inner sep=0pt,anchor=north] at (current page.north) {\includegraphics[width=\paperwidth]{book/img/header-part-circ}};
      % \node[inner sep=0pt,anchor=north west] at (current page.north west) {\includegraphics[width=.5\paperwidth]{book/img/header-part}};
      % \node[xscale=-1, inner sep=0pt, anchor=north west] at (current page.north east) {\includegraphics[width=.5\paperwidth]{book/img/header-part}};
    \end{tikzpicture}
  }
}

\fancypagestyle{chapter}{
  \thispagestyle{fancy}
  \fancyhead[O]{
    \begin{tikzpicture}[remember picture,overlay]
      \node[inner sep=0pt] at (current page.center) {\includegraphics[width=\paperwidth,height=\paperheight]{\backgroundr}};
      % \node[inner sep=0pt,anchor=north west] at (current page.north west) {\includegraphics[width=.5\paperwidth]{book/img/header-chapter}};
      % \node[xscale=-1, inner sep=0pt, anchor=north west] at (current page.north east) {\includegraphics[width=.5\paperwidth]{book/img/header-chapter}};
    \end{tikzpicture}
  }
}

\fancypagestyle{chapter}{
  \thispagestyle{fancy}
  \fancyhead[E]{
    \begin{tikzpicture}[remember picture,overlay]
      \node[inner sep=0pt] at (current page.center) {\includegraphics[width=\paperwidth,height=\paperheight]{\backgroundl}};
      % \node[inner sep=0pt,anchor=north west] at (current page.north west) {\includegraphics[width=.5\paperwidth]{book/img/header-chapter}};
      % \node[xscale=-1, inner sep=0pt, anchor=north west] at (current page.north east) {\includegraphics[width=.5\paperwidth]{book/img/header-chapter}};
    \end{tikzpicture}
  }
}
